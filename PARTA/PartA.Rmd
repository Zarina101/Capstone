---
title: "Data Wrangling and EDA"
author: "Ulita Gilbert"
date: "11 May 2021"
output:
  html_document:
    fig_caption: yes
    number_sections: yes
    toc: yes
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#import libraries

library(tidyverse)
library(ggplot2)
library(readxl)
library (janitor)
library(skimr)
library(plotly)
library(scales)
library(httr)
library(jsonlite)
library(lubridate)
```

# Data Dictionary

The population in this dataset is the incoming freshman student cohort in Fall 2019 and  Fall 2020. These students are first time degree or certificate seekers and have no prior tertiary education. They may have earned AP credits in highschool. Dual enrollment students i.e students who are taking credits at Montgomery College but have not completed a high school diploma are not included in the cohort. For the purposes of this Project the following terminology and variables are of importantance:    

**Terminology:**  
**Fall2019** refers to the incoming freshman cohort in Fall2019. This is term year 2020.    
**Fall2020** refers to the incoming freshman cohort in Fall2020. This is term year 2021.  

**Variables of Interest:**   
**term year:** incoming students in Fall 2019 are assigned to term year 2020. Incoming students in Fall 2020 are assigned to term year 2021.    
**hours_earned:** refers to credit hours the student has earned in their first Fall semester. This can include credits earned in Summer school second session (Summer 2) and AP credits earned in high school.    
**hours_attempted:** refers to credit  and non credit hours the student has attempted in their first Fall semester. This may include credits attempted in Summerschool second session - Summer 2.    
**full_part:** is the student full-time (FT) or part-time (PT). This classification is based on the students self reported information in the admissions application. Students are classified as full-time if they intend to take at least 12 credits.   
**major:** degree programme student is registered for or certificate&LR ( letter of recommendation.) All certificates and letters of recommendations have been grouped together.     
**hours_earned_rate:** Ratio of hours_earned/hours_attempted   
**age:** age of student at the start of program.    
**race:** racial classification of student. This is based on the IPEDS system. Foreign students are identified as foreign and not by their race/ethnicity.  
**sex:** gender classification of student.  
**high_school:** name of highschool student graduted from. Public High schools in Montgomery county are classified as MCPS.  
**pell:** Whether the student received a pell grant or not.   




# Data Wrangling

## Import Data
```{r}
#import data for Fall 2016 to Fall 2020
# set directory
setwd('/Users/ulita/Documents/CAPSTONE205/PARTA')

initial_df_2019<-read_xlsx("FTEIC F19.xlsx")
initial_df_2020<-read_xlsx("FTEIC F20.xlsx")

```

Read in files from dataMontgomery
```{r,message=FALSE}
#Access list of all highschools in Montgomery County. This will be used to filter highschools in student dataset.

r <- GET('https://data.montgomerycountymd.gov/resource/bfcv-pyzh.json')

#glimpse(r)
#content(r, "text")

jsonRespText <- content(r, as="text")
jsonRespParsed <- content(r, as="parsed")
#jsonRespParsed

df_MC <- fromJSON(jsonRespText)
#head(df_MC)
#class(df_MC)
df_MCPS <- as_tibble(df_MC)

```



## Create Dataframe

```{r}
 #create dataframe to compare credits in Fall 2019 and Fall 2020 :    df_credits 
df_initial<- bind_rows(initial_df_2019,initial_df_2020)

head(df_initial)
```


## Select Columns of Interest & Format Names
```{r}

#clean names using janitor package
df_initial<-df_initial %>%
             clean_names()

#drop columns not interested in

df_initial<-df_initial %>%
            dplyr::select(c(1:20))

# rename columns to make it user friendly
df_initial<-df_initial %>%
            rename("age"= "age_at_start", "race"= "ipeds_race_desc", 'summer2'= "term_year1_10", 'fall'='term_year1_20')

```  


## Overview of Data
```{r}
# summary statistics of dataframing using function skimr creates a table of summary statistics of all variables in the dataframe
skim(df_initial)
```

There are 18 variables and 7519 rows of data. Each row of data represents 1 student. 
There are 3931 rows of data for Fall2019 and 3588 rows of data for Fall2020.
Need to change the data types for hours_attempted and hours_earned to numeric. u_number should be a charater. 
Most of the missing values are in camp_code. For the purposes of this exercise, this variable is not important.
There are also 87 missing values in hours attempted and hours earned. As these two are the variables of interest and GPA are of interest, I will drop the rows in these variables with missing values.

## Change Datatypes
```{r}
# Change datatypes
df_initial$hours_attempted<- as.integer(df_initial$hours_attempted)
df_initial$hours_earned<- as.integer(df_initial$hours_earned)
df_initial$mc_gpa<- as.double(df_initial$mc_gpa)
df_initial$u_number<- as.character(df_initial$u_number)
df_initial$zip<- as.character(df_initial$zip)

#drop missing values in hours_attempted, hours_earned and mc_gap

df_initial <- df_initial %>%
              drop_na(hours_attempted,hours_earned)

```

Summarise data again
```{r}
skim(df_initial)
```

After removing the missing values in hours_earned and hours_attempted. There are 8 missing values in Fall. Closer inspection shows that these 8 students have a GPA of 0 even though there are hours attempted and hours earned. I will remove these students. 
```{r}
# remove students whose Fall term is NA

df_initial <- df_initial%>%
              filter(., !is.na(fall))
              
skim(df_initial)

```


## Missing Values and data Anomalies

```{r}

df_initial%>% group_by(term_year,full_part)%>%
                      count(hours_attempted==0)

```
Term year 2020: There are 3 full time and 27 part time students who attempted zero hours.
Term year 2021: There are 17 part time students who attempted zero hours.
These 47 observations will be dropped.

```{r}
# remove students who attempted 0 hours

df_initial <- df_initial%>%
              filter(., hours_attempted != 0)
              
skim(df_initial)

```



Check missing values in variable major
```{r}

#check majors list for undeclared and missing values.

df_initial%>% count(major)
dim(df_initial)
```

There are 72 students with undeclared majors. 16 students with majors listed as 0 and 33 listed as NA.
Due to privacy reasons, students have been grouped so as not to identify individual students. Degree Major groupings with less than 10 students have been listed as NA or 0. At this point in time I will not remove these data points, because for the purposes of this study, Major names are not required. 
Students enrolled for a certificate or Letter of Recommendation have been grouped togther irrespective of field.


There are 221 Certificate & LR students in the initial dataset. I will drop these non-degree programmes
and focus on degree majors only.


Create dataframe with degrees only.
I have retained the majors grouped as NA and 0.
```{r}

#remove certificates, NA refers to degree majors which have not been named to protect student privacy.
df_Degrees<-subset(df_initial, major!="Certificate & LR")
df_Degrees%>%count(major)
```

save dataframe Degrees
```{r}
write.csv(df_Degrees,'df_Degrees.csv')

```

# Demographics of Degree Seeking Students


## Full time versus Part-time Degree Students
```{r}
#count number of full time versus part-time degree students.

df_Degrees%>% group_by(term_year)%>%
              count(full_part)


```

```{r}
# change in overall student population from 2020 to 2021

df_Degrees%>%
          group_by(term_year,full_part)%>%
          count(full_part)%>%
          group_by(term_year)%>%
          mutate(total_pop =sum(n))%>%
          group_by(full_part)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_change= (n-lag(n))/lag(n)*100) 
```

```{r}
# decrease in total student population
((2251+1606)-(2147+1373))/(2251+1606)*100
```
Degree Seeking students:
There was an 8.7% decrease in the incoming cohort ( part time and full time) size from 2020 to 2021. 
In term year 2020, there were 2222 full time degree seeking students and 1527 part time degree seeking students.
In term year 2021, there were 2088 full time degree seeking students and 1286 part time degree seeking students.
There is a 6 % drop in full time enrollment from 2020 to 2021. There is a 15.78 % drop in part time enrollment from 2020 to 2021.


Frequency of Students Part time versus Full time: 2020 vs 2021
```{r}

# Number of students part time abnd full time  2020 vs 2021
ggplot(data=df_Degrees, aes(x=full_part, fill=full_part)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=2,size=3)+
      facet_wrap(~term_year)+
      ggtitle("Number of Students Full time versus Part time")+
      ylab('Frequency')+
      xlab("")+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
   
```


Proportion of Students Full time versus Part time: 2020 vs 2021
```{r}

df_Degrees %>% 
    group_by(term_year) %>% 
    count(full_part) %>% 
    mutate(prop = n/sum(n)) %>% 
    ggplot(aes(x = full_part, y = prop)) +
    geom_col(aes(fill = full_part), position = "dodge") +
    geom_text(aes(label = scales::percent(prop), 
                  y = prop, 
                  group = full_part),
              position = position_dodge(width = 0.9),
              vjust = 2,size=3)+
   facet_wrap(~term_year)+
      ggtitle("Proportion of Students Full time versus Part time")+
      ylab('Percentage')+
      xlab("")+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
   

```

Approximately 3/5 of students in each term year are full time and 2/5 are part time.

## Race

Count of Race Groups
```{r}
ggplot(data=df_Degrees, aes(x=race, fill=race)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=0,size=3)+
      facet_wrap(~term_year + full_part)+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())+
      ggtitle("Number of Students per a Race Group")+
      xlab("Race")+
      ylab("Frequency")


```
Percentage of each race group in Student Population
```{r}
df_Degrees %>% 
    group_by(term_year,full_part) %>% 
    count(race) %>% 
    mutate(prop = n/sum(n)) %>% 
    ggplot(aes(x = race, y = prop)) +
    geom_col(aes(fill = race), position = "dodge") +
    geom_text(aes(label = scales::percent(prop,0.1), 
                  y = prop, 
                  group = race),
              position = position_dodge(width = 0.9),
              vjust = 0,size=3)+
    facet_wrap(~term_year + full_part)+
      ggtitle("Race Proportion of Students: Full time versus Part time")+
      ylab('Proportion ')+
      xlab("")+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
   

```
Hispanic students form the largest proportion in the full time and part time student populations, followed by African American, White, Asian and Foreign students. 


```{r}

df_Degrees%>% 
  filter(full_part=='FT')%>%
    group_by(race,term_year)%>%
   tally() 

```

Full time student: Change in enrollment from 2020 to 2021 based on Race
```{r}
# calculate percentage change in full time student enrollment from 2020 to 2021 by  race

df_Degrees%>%
          filter(full_part=="FT")%>%
          group_by(term_year,race)%>%
          count(race)%>%
          group_by(race)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_change= (n-lag(n))/lag(n)*100) 
```
Full time students: In 2021 there was a 10.57% increase of Hispanic students when compared to 2020.The was a 12.83 % decrease in African American Students,
13.84 % decrease in Asian Students, a 7,54% decrease in white students and a 17.81% decrease in foreign students. 


Part time student: Change in enrollment from 2020 to 2021 based on Race
```{r}

df_Degrees%>% 
  filter(full_part=='PT')%>%
    group_by(race,term_year)%>%
   tally() 

```
Part time student: Change in enrollment from 2020 to 2021 based on Race
```{r}
# calculate percentage change in part time student enrollment from 2020 to 2021 by  race

df_Degrees%>%
          filter(full_part=="PT")%>%
          group_by(term_year,race)%>%
          count(race)%>%
          group_by(race)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_change= (n-lag(n))/lag(n)*100) 
```

Part time degree seeking students: In 2021 there was a 19.35% decrease of Hispanic part time degree seeking students when compared to 2020.
The was a 12.87 % decrease in African American Students, 23.48 % decrease in Asian Students, a 6.59% increase in white students and a 39.52% decrease in foreign students. 


## Age
Age distribution of Students Part time versus Full tim: 2020 vs 2021
```{r}

# Age distribution of students 2020 vs 2021
ggplot(data=df_Degrees, aes(x=age, fill=age)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=0,size=3)+
      facet_wrap(~term_year+full_part)+
      ggtitle("Age Distribution of Students: Full time versus Part time")+
      ylab('Frequency')+
      xlab("")+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
   
```

Age distribution of Full time Students

```{r}
df_Degrees%>%
          filter(full_part=="FT")%>%
          group_by(term_year,age)%>%
          count(age)%>%
          group_by(term_year)%>%
          mutate(total_pop =sum(n))%>%
          group_by(age)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_pop= (n/total_pop*100))
```

In term year 2020 and term year 2021, approximately 85% of the full time and part time students are between 18-20yrs.
In term year 2020, 66.86% of the part time students were between 18-20yrs and in term year 2021, 70.68% students. 

Age distribution of Part time Students
```{r}
df_Degrees%>%
          filter(full_part=="PT")%>%
          group_by(term_year,age)%>%
          count(age)%>%
          group_by(term_year)%>%
          mutate(total_pop =sum(n))%>%
          group_by(age)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_pop= (n/total_pop*100))
```

The part time student population in term year 2020 and term year 2021 has a higher proportion of 21-24, 25-29 and 30+ and a lower proportion of under 18s than the full time student population. 


## Gender
Gender of Students 
```{r}

# Gender of students part time and full time  2020 vs 2021
ggplot(data=df_Degrees, aes(x=sex, fill=sex)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=1,size=3)+
      facet_wrap(~term_year+full_part)+
      ggtitle("Gender of Students: Full time versus Part time")+
      ylab('Frequency')+
      xlab("")+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
   
```

Gender 0 and Gender N are unknown values, however they have not been removed from the dataset as the variables of interest are hours_attempted and hours_earned. Some students choose not to report a gender. This is approximately 1% of the student population.

Percentage of Full time Students by Gender
```{r}
df_Degrees%>%
          filter(full_part=="FT")%>%
          group_by(term_year,sex)%>%
          count(sex)%>%
          group_by(term_year)%>%
          mutate(total_pop =sum(n))%>%
          group_by(sex)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_pop= (n/total_pop*100))
```

In term year 2020, there was approximately 2.7% more full time male students than full time female students.
In term year 2021, there was approximately 5.6% more full time female students than full time male students.
It is evident that the full time male population have decreased more than the full time female student population in term year 2021. 


Percentage of Part time Students by Gender
```{r}
df_Degrees%>%
          filter(full_part=="PT")%>%
          group_by(term_year,sex)%>%
          count(sex)%>%
          group_by(term_year)%>%
          mutate(total_pop =sum(n))%>%
          group_by(sex)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_pop= (n/total_pop*100))
```

In term year 2020, there was approximately 6.02% more part time female students than part time male students.
In term year 2021, there was approximately 5.36% more part time female students than part time male students.

Calculate percentage change in full time student enrollment from 2020 to 2021 by  gender
```{r}
# calculate percentage change in full time student enrollment from 2020 to 2021 by  gender

df_Degrees%>%
          filter(full_part=="FT")%>%
          filter(sex=="F"|sex =="M")%>%
          group_by(term_year,sex)%>%
          count(sex)%>%
          group_by(sex)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_change= (n-lag(n))/lag(n)*100) 
```

Full time male students: 13.74% decline in registration
Full time female students: 2.06% increase in registration

Calculate percentage change in part time student enrollment from 2020 to 2021 by  gender
```{r}
# calculate percentage change in part time student enrollment from 2020 to 2021 by  gender

df_Degrees%>%
          filter(full_part=="PT")%>%
          filter(sex=="F"|sex =="M")%>%
          group_by(term_year,sex)%>%
          count(sex)%>%
          group_by(sex)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_change= (n-lag(n))/lag(n)*100) 
```

Part time male students: 14.55% decrease in registration
Part time female students: 15.76% decrease in registration

Gender and Race breakdown of full time students
```{r}
# Gender and Race of full time students  2020 vs 2021

df_Degrees%>%
      filter(sex %in% c("F","M"))%>%
      filter(full_part=="FT")%>%
      ggplot(., aes(x=race, fill=race)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=0, size=3)+
      facet_wrap(~term_year+sex)+
      ggtitle("Gender and Race of Full time Students")+
      ylab('Frequency')+
      xlab("")+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())

#    theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())

```

Gender and Race breakdown of part time students
```{r}
# Gender and Race of part time students 2020 vs 2021

df_Degrees %>%
      filter(sex %in% c("F","M"))%>%
      filter(full_part=="PT")%>%
      ggplot(., aes(x=race, fill=race)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=0,size=3)+
      facet_wrap(~term_year+sex)+
      ggtitle("Gender and Race of Part time Students")+
      ylab('Frequency')+
      xlab("")+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())



```

Full time Student Enrollment Percentages trend by Gender and race

```{r}
# calculate percentage change in student enrollment from 2020 to 2021 by race and gender

# create data frames with counts of full time students by race and gender
df_Degrees%>%
          filter(full_part=="FT")%>%
          filter(sex=="F"|sex =="M")%>%
          group_by(term_year,race,sex)%>%
          count(sex)%>%
          group_by(race,sex)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_change= (n-lag(n))/lag(n)*100) 
```
Full time male students: There was a 25% decrease in asian male students, 21.23 % decrease in african american males, a 23.91% decrease in foreign males, a 10.84% decrease in white males and a 2.68% increase in Hispanic males. 
Full time female students: 2.26 % decrease in african american females, a 13.33% decrease in foreign females,
a 4.61% decrease in white females and a 17.63% increase in Hispanic females. 


Part time Student Enrollment Percentages trend by Gender and race
```{r}
# calculate percentage change in student enrollment from 2020 to 2021 by race and gender

# create data frames with counts of full time students by race and gender
df_Degrees%>%
          filter(full_part=="PT")%>%
          filter(sex=="F"|sex =="M")%>%
          group_by(term_year,race,sex)%>%
          count(sex)%>%
          group_by(race,sex)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_change= (n-lag(n))/lag(n)*100) 
```
Part time male students:  20.23 % decrease in african american males, a 40% decrease in foreign males, a 25.68% decrease in Hispanic males and a 20.87% icrease in white males . 
Part time female students: 8.29 % decrease in african american females, a 39.76 decrease in foreign females, a 2.9% decrease in white females,a 40.58% decrease in asian females and a 11.76% decrease in Hispanic females. 


## Pell grant

```{r}

# Pell Grant
ggplot(data=df_Degrees, aes(x=pell_grant, fill=pell_grant)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=3, size=3)+
      facet_wrap(~term_year+full_part)+
      ggtitle("Pell grant")+
      ylab('Frequency')+
      xlab("")+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
   
```

Percentage of each race group in Student Population
```{r}
df_Degrees %>% 
    group_by(term_year,full_part) %>% 
    count(pell_grant) %>% 
    mutate(prop = n/sum(n)) %>% 
    ggplot(aes(x = pell_grant, y = prop)) +
    geom_col(aes(fill = pell_grant), position = "dodge") +
    geom_text(aes(label = scales::percent(prop,0.1), 
                  y = prop, 
                  group = pell_grant),
              position = position_dodge(width = 0.9),
              vjust = 0,size=3)+
    facet_wrap(~term_year + full_part)+
      ggtitle("Proportion of Students receiving Pell Grants")+
      ylab('Proportion ')+
      xlab("")+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
   

```

Full time: Slightly highly proportion of pell grant recipients in term year 2020. 
Approximately 1/2 of the full time students receive pell grants.
Part time: The proportion of students receiving pell grants is similar in both term years.
Approximately 2/5 ths of the part time students receive pell grants. 


## Highschool

```{r}

df_Degrees%>%group_by(term_year,full_part) %>% 
        count(high_school)

```



Filter highschools  MCPS

```{r}

# high school names in student data is listed as xxx High School, whilst in MCPS it is abbreviated to HS.
# Modify MCPS dataframe to change HS to High School
# Modify MSCPS dataframe to match highschool names in MC College Student Data.

df_MCPS<- 
  df_MCPS %>%
  mutate(across("school_name", str_replace, "HS", "High School"))

```

```{r}

#Correct discrepanies in names for MCPS highschools. 
# Reason: discrepancies in names in MC College data versus Montgomery Data.
# MC College corrections : Bethesda Chevy Chase High Schl, Thomas Sprigg Wootton High Sch, Poolesville Jr-Sr High School,Colonel Zadok Magruder HS,
#Northwest HS - Germantown, Quince Orchard Sr High School,Albert Einstein HS & MC Art Cn, John F. Kennedy High School,Springbrook Sr High School,

df_MCPS<- 
  df_MCPS %>%
  mutate(across("school_name", str_replace, "Bethesda-Chevy Chase High School", "Bethesda Chevy Chase High Schl"))
df_MCPS<- 
  df_MCPS %>%
  mutate(across("school_name", str_replace, "Thomas S Wootton High School", "Thomas Sprigg Wootton High Sch"))
df_MCPS<- 
  df_MCPS %>%
  mutate(across("school_name", str_replace, "Poolesville High School", "Poolesville Jr-Sr High School"))
df_MCPS<- 
  df_MCPS %>%
  mutate(across("school_name", str_replace, "Col Zadok Magruder High School", "Colonel Zadok Magruder HS"))
df_MCPS<- 
  df_MCPS %>%
  mutate(across("school_name", str_replace, "Northwest High School", "Northwest HS - Germantown"))
df_MCPS<- 
  df_MCPS %>%
  mutate(across("school_name", str_replace, "Quince Orchard High School", "Quince Orchard Sr High School"))
df_MCPS<- 
  df_MCPS %>%
  mutate(across("school_name", str_replace, "Albert Einstein High School", "Albert Einstein HS & MC Art Cn"))
df_MCPS<- 
  df_MCPS %>%
  mutate(across("school_name", str_replace, "John F Kennedy High School", "John F. Kennedy High School"))
df_MCPS<- 
  df_MCPS %>%
  mutate(across("school_name", str_replace, "Springbrook High School", "Springbrook Sr High School"))



 
df_MCPS
```


```{r}


df_Degrees<- df_Degrees %>%
              mutate( MCPS = df_Degrees$high_school%in% df_MCPS$school_name)

df_Degrees%>%
  group_by(term_year,full_part)%>%
  filter(MCPS==TRUE)%>%
  count(high_school)
```


create highschool catergories: MCPS , Foreign, Homeschool, Out of State, Other MD ( private schools and MD public schools not in MCPS), DC( District of Columbia)

```{r}

df_Degrees<- df_Degrees%>%
              mutate(HS_classify= case_when(
                .$high_school == "** HOME SCHOOLED **" ~ "home_school", 
                .$high_school == "FOREIGN / INTERNATIONAL HS"~"Foreign",
                .$high_school == "G. E. D."~"GED",
                .$MCPS == TRUE~"MCPS",
                .$high_school=="DISTRICT OF COLUMBIA HS"~"DC",
                .$high_school == "Out of State High School"~"Out of State",
                TRUE~"Other In State"))
```




count number of MCPS graduates in cohort in term years 2020 and 2021
```{r}

df_Degrees%>%group_by(term_year,full_part) %>% 
        count(MCPS)

```

```{r}

df_Degrees%>%group_by(term_year,full_part) %>% 
        count(HS_classify)

```

Count of High Schools
```{r}
ggplot(data=df_Degrees, aes(x=HS_classify, fill=HS_classify)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=0,size=3)+
      facet_wrap(~term_year + full_part)+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())+
      ggtitle("High Schools Students' Graduated  ")+
      xlab("High School")+
      ylab("Frequency")


```
The majority of full time and part time students are from MCPS highschools


Proportion of Students from Highschools
```{r}
df_Degrees %>% 
    group_by(term_year,full_part) %>% 
    count(HS_classify) %>% 
    mutate(prop = n/sum(n)) %>% 
    ggplot(aes(x = HS_classify, y = prop)) +
    geom_col(aes(fill = HS_classify), position = "dodge") +
    geom_text(aes(label = scales::percent(prop,0.5), 
                  y = prop, 
                  group = HS_classify),
              position = position_dodge(width = 0.9),
              vjust = 0.25,size=3)+
    facet_wrap(~term_year + full_part)+
      ggtitle("High schools students graduated")+
      ylab('Proportion ')+
      xlab("")+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
   

```
75.5% of full time degree students in term year 2020 and term year 2021 graduated from MCPS highschools.
58% of part time degree students in term year 2020 and 64% of part time students in term year 2021 graduated from MCPS highschool.

Breakdown of Highschools Full time students in term year 2020 attended in MCPS
```{r}
df_Degrees%>%
          filter(full_part=="FT" & term_year=="2020")%>%
          filter(HS_classify=="MCPS")%>%
          group_by(term_year,high_school)%>%
          count(high_school)%>%
          group_by(term_year)%>%
          mutate(total_pop =sum(n))%>%
          group_by(high_school)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_pop= (n/total_pop*100))%>%
          arrange(desc(pct_pop))
  
```


The Graph below gives the overall proportions of full time students from highschools in MCPS in term_year 2020. There are 25 highschools in Montgomery County.
The table above give the percentages of Full time students who attended each high school.
In term year 2020: 
7.93% of full time students finished high school at Gaithersburg High. 
6.32% from Montgomery Blair HS.
5.54% from Springbok Sr High School.
5.49% from Northwest HS - Germantown.
5.49% from Paint Branch High School.
9 highschools had between 4% and 5%
On the other end of the spectrum:
Walt Whitman High School at 1.13%.
Poolesville Jr-Sr High School 1.31%
Winston Churchill 2.03%
Thomas Sprigg Wootton High Sch 2.03%




```{r}
v1<- df_Degrees %>% 
    group_by(term_year,full_part) %>% 
    filter(full_part=="FT" & term_year=="2020")%>%
    filter(HS_classify=="MCPS")%>%
    count(high_school) %>% 
    mutate(prop = n/sum(n)) %>% 
    ggplot(aes(x = high_school, y = prop)) +
    geom_col(aes(fill=high_school), position = "dodge") +
    geom_text(aes(label = scales::percent(prop,0.5), 
                  y = prop, 
                  group = high_school),
              position = position_dodge(width = 0.9),
              vjust = 0, size=3, hjust=0)+
  #  facet_wrap(~term_year )+
      ggtitle("High schools full time students graduated in term year 2020 graduated")+
      ylab('Proportion ')+
      xlab("")+
      theme(legend.position = "none", axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank()) 
  
v1+ coord_flip()  
```


Breakdown of Highschools Full time students in term year 2021 attended in MCPS
```{r}
df_Degrees%>%
          filter(full_part=="FT" & term_year=="2021")%>%
          filter(HS_classify=="MCPS")%>%
          group_by(term_year,high_school)%>%
          count(high_school)%>%
          group_by(term_year)%>%
          mutate(total_pop =sum(n))%>%
          group_by(high_school)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_pop= (n/total_pop*100))%>%
          arrange(desc(pct_pop))

```

```{r}
v2<-df_Degrees %>% 
    group_by(term_year,full_part) %>% 
    filter(full_part=="FT" & term_year=="2021")%>%
    filter(HS_classify=="MCPS")%>%
    count(high_school) %>% 
    mutate(prop = n/sum(n)) %>% 
    ggplot(aes(x = high_school, y = prop)) +
    geom_col(aes(fill=high_school), position = "dodge") +
    geom_text(aes(label = scales::percent(prop,0.5), 
                  y = prop, 
                  group = high_school),
              position = position_dodge(width = 0.9),
              vjust = 0, size =3,hjust=0)+
  #  facet_wrap(~term_year )+
      ggtitle("High Schools Full time students in term year 2021 graduated")+
      ylab('Proportion ')+
      xlab("")+
      theme(legend.position = "none", axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank()) 
  
v2+ coord_flip()   
```


```{r}
# calculate percentage change in full time student enrollment from 2020 to 2021 by MCPS highschool
df_Degrees%>%
          filter(full_part=="FT")%>%
          filter(HS_classify=="MCPS")%>%
          group_by(term_year,high_school)%>%
          count(high_school)%>%
          group_by(term_year)%>%
          group_by(high_school)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_change= (n-lag(n))/lag(n)*100)
     
  
```

Full time students: Gaitherburg High had a 31.58% decrease in enrollment. Poolesville Jr-Sr High School 36.36% decrease. Springbrook Sr High School a 31.18% decrease.
Walter Johnson High School 28.38% decrease. Rockville High increased enrollment by 40.43%


Highs Schools Part time Students Graduated from. term year 2020 vs term year 2021

Part time students term year 2020: 
```{r}
q1<- df_Degrees %>% 
    group_by(term_year,full_part) %>% 
    filter(full_part=="PT" & term_year=="2020")%>%
    filter(HS_classify=="MCPS")%>%
    count(high_school) %>% 
    mutate(prop = n/sum(n)) %>% 
    ggplot(aes(x = high_school, y = prop)) +
    geom_col(aes(fill=high_school), position = "dodge") +
    geom_text(aes(label = scales::percent(prop,0.5), 
                  y = prop, 
                  group = high_school),
              position = position_dodge(width = 0.9),
              vjust = 0, size=3, hjust=0)+
  #  facet_wrap(~term_year )+
      ggtitle("High schools Part time students graduated in term year 2020 graduated")+
      ylab('Proportion ')+
      xlab("")+
      theme(legend.position = "none", axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank()) 
  
q1+ coord_flip()  
```

Part time students term year 2021: 
```{r}
q2<- df_Degrees %>% 
    group_by(term_year,full_part) %>% 
    filter(full_part=="PT" & term_year=="2021")%>%
    filter(HS_classify=="MCPS")%>%
    count(high_school) %>% 
    mutate(prop = n/sum(n)) %>% 
    ggplot(aes(x = high_school, y = prop)) +
    geom_col(aes(fill=high_school), position = "dodge") +
    geom_text(aes(label = scales::percent(prop,0.5), 
                  y = prop, 
                  group = high_school),
              position = position_dodge(width = 0.9),
              vjust = 0, size=3, hjust=0)+
  #  facet_wrap(~term_year )+
      ggtitle("High schools Part time students graduated in term year 2020 graduated")+
      ylab('Proportion ')+
      xlab("")+
      theme(legend.position = "none", axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank()) 
  
q2+ coord_flip()  
```
Breakdown of Highschools Part time students in term year 2020 attended in MCPS
```{r}
df_Degrees%>%
          filter(full_part=="PT" & term_year=="2020")%>%
          filter(HS_classify=="MCPS")%>%
          group_by(term_year,high_school)%>%
          count(high_school)%>%
          group_by(term_year)%>%
          mutate(total_pop =sum(n))%>%
          group_by(high_school)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_pop= (n/total_pop*100))%>%
          arrange(desc(pct_pop))

```

Breakdown of Highschools Part time students in term year 2021 attended in MCPS
```{r}
df_Degrees%>%
          filter(full_part=="PT" & term_year=="2021")%>%
          filter(HS_classify=="MCPS")%>%
          group_by(term_year,high_school)%>%
          count(high_school)%>%
          group_by(term_year)%>%
          mutate(total_pop =sum(n))%>%
          group_by(high_school)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_pop= (n/total_pop*100))%>%
          arrange(desc(pct_pop))

```


```{r}
# calculate percentage change in part time student enrollment from 2020 to 2021 by MCPS highschool
df_Degrees%>%
          filter(full_part=="PT")%>%
          filter(HS_classify=="MCPS")%>%
          group_by(term_year,high_school)%>%
          count(high_school)%>%
          group_by(term_year)%>%
          group_by(high_school)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_change= (n-lag(n))/lag(n)*100)
     
```


## Majors

Overall Majors trend

Count of Majors in Full time students in 2020
```{r}
z1<- df_Degrees%>%
      filter(full_part=="FT" &term_year =="2020")%>%
       ggplot(., aes(x=major, fill=major)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=0, hjust=0, size =3)+
      ggtitle("Majors of Full-time Students in 2020  ")+
      xlab("Major")+
      ylab("Frequency")+
    theme(legend.position = "none") 
       
z1 + coord_flip()
```


Count of Majors in Full time students in 2021
```{r}
z13<- df_Degrees%>%
      filter(full_part=="FT" &term_year =="2021")%>%
       ggplot(., aes(x=major, fill=major)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=0, hjust=0, size =3)+
      ggtitle("Majors of Full-time Students in 2021  ")+
      xlab("Major")+
      ylab("Frequency")+
    theme(legend.position = "none") 
       
z13 + coord_flip()
```

calculate percentage change in full time student majors from 2020 to 2021 
```{r}
df_Degrees%>%
          filter(full_part=="FT")%>%
          group_by(term_year,major)%>%
          count(major)%>%
          group_by(term_year)%>%
          group_by(major)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_change= (n-lag(n))/lag(n)*100)
```
 Full time students:  
 In term year 2020, the 3 most popular majors at the college where General Studies, Business and Science.
 In term year 2021, the 3 most popular majors at the college where General Studies, Business and Health Science.
 General studies saw a 28% decrease in enrollment,  business studies increased by 8.24% and Health Sciences increased by 38%.
 Enrollment in Education related fields increased by 57.14%, however this is not one of the popular majors at the college.
 


Count of Majors in Part time students in 2020
```{r}
z11<- df_Degrees%>%
      filter(full_part=="PT" &term_year =="2020")%>%
       ggplot(., aes(x=major, fill=major)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=0, hjust=0, size =3)+
      ggtitle("Majors of Part-time Students in 2020  ")+
      xlab("Major")+
      ylab("Frequency")+
    theme(legend.position = "none") 
       
z11 + coord_flip()
```
Count of Majors in Part time students in 2021
```{r}
z12<- df_Degrees%>%
      filter(full_part=="PT" &term_year =="2021")%>%
       ggplot(., aes(x=major, fill=major)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=0, hjust=0, size =3)+
      ggtitle("Majors of Part-time Students in 2021  ")+
      xlab("Major")+
      ylab("Frequency")+
    theme(legend.position = "none") 
       
z12 + coord_flip()
```

calculate percentage change in part time student majors from 2020 to 2021 
```{r}
df_Degrees%>%
          filter(full_part=="PT")%>%
          group_by(term_year,major)%>%
          count(major)%>%
          group_by(term_year)%>%
          group_by(major)%>%
          arrange(term_year,.by_group=TRUE)%>%
          mutate(pct_change= (n-lag(n))/lag(n)*100)
```

The 3 most popular part time majors in term year 2020 were General Studies, Health Sciences and Business. In term year 2021, the
3 most popular majors were General Studies, Health Sciences and Business, however enrollment decreased by 27.67%, 16.92% and 24.71% respectively.
Interestly in term year 2020, there were more part-time (195 students) than full-time (142 students) Health Science Majors. 
In term year 2021, there are more full-time (196 students) than part-time (162 students) Health Science Majors.
The covid pandemic may have created an interest in Health Sciences or those students who would have done the course part-time in term year 2021, may have opted to do it full-time. 

## Majors by Race and Gender

Filter the 5 most popular majors and 5 race groups that make up the largest proportion of the student population.
General Studies, Health Science, Science, Business, Computer Science

```{r}

df_popMajors<-df_Degrees%>%
  filter(major %in% c("General Studies","Business", "Health Sciences", "Computer Science", "Science"))

df_popMajorsR<-df_popMajors%>%
  filter(race %in%c("Black / African Am.","White","Asian","Hispanic","Foreign"))
```


Popular Majors of Full time students by year
```{r}
df_popMajors%>%
  filter(full_part=="FT")%>%
      ggplot(., aes(x=major, fill=major)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=0, hjust=0.5, size =3)+
      facet_wrap(~term_year)+
      ggtitle("Popular Majors of Full-time students ")+
      xlab("")+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
```


Popular Majors of Part-time students by year
```{r}
df_popMajors%>%
  filter(full_part=="PT")%>%
      ggplot(., aes(x=major, fill=major)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=0, hjust=0.5, size =3)+
      facet_wrap(~term_year)+
      ggtitle("Popular Majors of Part-time students ")+
      xlab("")+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
```

Majors of Full time students in term year 2020 by Race
```{r}
df_popMajorsR%>%
  filter(full_part=="FT" &term_year=="2020")%>%
      ggplot(., aes(x=race, fill=race)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=0, hjust=0.5, size =3)+
      facet_wrap(~major)+
      ylab("Majors of Full time students in term year 2020")+
      xlab("")+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
  


```


Majors of Full time students in term year 2021 by Race
```{r}
df_popMajorsR%>%
  filter(full_part=="FT" &term_year=="2021")%>%
      ggplot(., aes(x=race, fill=race)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=0, hjust=0.5, size =3)+
      facet_wrap(~major)+
      ylab("Majors of Full time students in term year 2020")+
      xlab("")+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
  


```


Majors of Part time students in term year 2020 by Race

```{r}
df_popMajorsR%>%
  filter(full_part=="PT" &term_year=="2020")%>%
      ggplot(., aes(x=race, fill=race)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=0, hjust=0.5, size =3)+
      facet_wrap(~major)+
      ylab("Majors of Full time students in term year 2020")+
      xlab("")+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
  


```


Majors of Part time students in term year 2021 by Race
```{r}
df_popMajorsR%>%
  filter(full_part=="PT" &term_year=="2021")%>%
      ggplot(., aes(x=race, fill=race)) +
      geom_bar() +
      geom_text(stat='count', aes(label=..count..), vjust=0, hjust=0.5, size =3)+
      facet_wrap(~major)+
      ylab("Majors of Full time students in term year 2020")+
      xlab("")+
      theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
  


```




# Registration in Summer School 2
Hours attempted in Summer 2 are reported with hours_attempted in Fall.
Credits earned in Summer 2 are usually reported with hours earned in Fall.
```{r}
#count number of full time versus part-time degree students.

df_Degrees%>% group_by(term_year,full_part)%>%
                     count(summer2=='Y')


```
There are 0 students who have attended Summer2. 
Hence values reported for hours_earned are only for credits earned in fall and AP credits.
hours_attempted in Fall are only for non credit developmental courses and credit courses taken in Fall.



# Hours Attempted by Degree Seeking Students

```{r}
# AP credits can be given for courses taken at highschool.
#Check number of students with hours_earned greater than hours_attempted

df_Degrees %>% count(hours_attempted<hours_earned)
```
There are 5 students with attempted hours smaller than hours earned. 


Histogram of hours_attempted by year
```{r}

p <- ggplot(df_Degrees, aes(x = hours_attempted))+ geom_histogram(aes(fill = term_year))
p1<- p + facet_wrap(~full_part)

p1
```


Boxplots of hours_attempted by year
```{r}
p11 = ggplot(df_Degrees, aes(hours_attempted))
p11 + geom_boxplot(aes(colour = term_year)) +
       facet_wrap(~full_part)
```

Density plot of hours_attempted by year
```{r}
ggplot(df_Degrees, aes(hours_attempted, fill = term_year)) + geom_density(alpha = 0.2) +
  facet_wrap(~full_part)+
  xlab("Hours attempted") +
  ylab( "Density")

```



Fivenum Summary
```{r}
df_Degrees%>% group_by(term_year,full_part)%>%
  summarise(n = n(),
            min = fivenum(hours_attempted)[1],
            Q1 = fivenum(hours_attempted)[2],
            median = fivenum(hours_attempted)[3],
            Q3 = fivenum(hours_attempted)[4],
            max = fivenum(hours_attempted)[5],
            mean= mean(hours_attempted),
            sd = sd(hours_attempted))


```



______Code not knitting

d1<-df_Degrees%>%
  filter(full_part=="FT")%>%
  filter(term_year=="2020")%>%
  dplyr::select(hours_attempted)

d2<-df_Degrees%>%
  filter(full_part=="FT")%>%
  filter(term_year=="2021")%>%
  dplyr::select(hours_attempted)

sband(d1,d2)
______

Hours Attempted by Full-time students: The distributions for the hours attempted by full time students in term year 2020 and term year 2021 have similar shapes.  The first quartile for both distributions is 12. The median for term year 2021 (14 hours attempted) is slightly higher than that in 2020 (13 hours attempted). The 3rd quartile for 2020 is 15, whilst in 2021 it is 16. Both distibutions are also skewed right and have similar tail lengths. The maxium for 2020 is 53 and in 2021 it is 54. The distribution for 2021 has lower peaks because there were less students enrolled in 2021 than in 2020. Peaks can be attributed to the fact that most courses are 3 or 4 credit courses. The college offers very few 2 credit courses. As both the median and 3rd quartile have increased by 1 hour, we can conclude that students where taking slightly more hours. 

Hours Attempted by Part-time students: The distributions for the hours attempted by part time students in term year 2020 and term year 2021 have similar shapes. The 1st quartile, the median and 3rd quartile are the same in both years. The tail is slightly shorter in term year 2021. It should be noted that this is population data and not sample data, however I have run a Wilcox Whitney Man Test.
At the 5% significance level we would not reject the null, hence there is not significant evidence that there is a difference between the part time population distribution for hours attempted in term year 2020 and term year 2021. Refer to the test below. 


Wilcox Mann Test for hours attempted by part-time students
```{r}

r1<- df_Degrees%>%
  filter(full_part=="PT")%>%
  filter(term_year=="2021")



r2<- df_Degrees%>%
  filter(full_part=="PT")%>%
  filter(term_year=="2020")

```

```{r}
wilcox.test(r1$hours_attempted,r2$hours_attempted)

```



Students who attempted more than 18hours require special written permision from the college.
```{r}

df_Degrees%>% group_by(term_year,full_part)%>%
                      count(hours_attempted>18)

```




# Hours Earned by Degree Seeking Students

Histogram of hours_earned by year
```{r}

p <- ggplot(df_Degrees, aes(x = hours_earned))+ geom_histogram(aes(fill = term_year))
p1<- p + facet_wrap(~full_part)

p1
```
Boxplots of hours_earned by year
```{r}
p11 = ggplot(df_Degrees, aes(hours_earned))
p11 + geom_boxplot(aes(colour = term_year)) +
       facet_wrap(~full_part)


```


Density plot of hours_earned by year
```{r}
ggplot(df_Degrees, aes(hours_earned, fill = term_year)) + geom_density(alpha = 0.2) +
  facet_wrap(~full_part)+
  xlab("Hours Earned") +
  ylab( "Density")
  
```
Hours Earned Fivenum Summary
```{r}
df_Degrees%>% group_by(term_year,full_part)%>%
  summarise(n = n(),
            min = fivenum(hours_earned)[1],
            Q1 = fivenum(hours_earned)[2],
            median = fivenum(hours_earned)[3],
            Q3 = fivenum(hours_earned)[4],
            max = fivenum(hours_earned)[5],
            mean= mean(hours_earned),
            sd = sd(hours_earned))


```

QQplot of hours earned by Fulltime Students.
```{r}

d1<- df_Degrees%>%filter(full_part=="FT")

p<-qplot(sample = hours_earned, data = d1, color=term_year)
p
```



Hours Earned Summary
The distributions appeared to be skewed to the right. Incoming students are allowed to get AP credits for courses taken at highschool.
The distributions for part-time student in 2020 and 2021 appear to follow a similar distribution. Peaks can be attributed to the fact that most courses are 3 or 4 credit courses. The college offers very few 2 credit courses. Students also need special permission to enroll in more than 18credits. 
Fulltime Students: The first quartile in term year 2020 and term year 2021 is 6 credits. The median for term year 2021 (10 hours earned) is 1 hour higher than the median in 2020 (9 hours earned). The 3rd quartile is 13 hours in both term years. Both distributions have long tails on the right, with 2020 having a maximum of 53 and 2021 having a maxium of 54. Hence based on the median, we can conclude that there was a slight increase in the hours earned by students. 

Part time Students: Both 2020 and 2021 follow a similar distribution. The first quartile for both years is 0. This means that 25% of part time students earn 0 credits. The median for both distributions is 3, ie. 50% of students earn up to 3 credits. The 3rd quartile for both distributions is 6. Both distributions have long tails.
It should be noted that this is population data and not sample data, however I have run a Wilcox Whitney Mann Test.
At the 5% significance level we would not reject the null, hence there is not significant evidence that there is a difference between the part time population distribution for hours earned in term year 2020 and term year 2021. Refer to the test below. 


Wilcox Mann Test

```{r}

r4<- df_Degrees%>%
  filter(full_part=="PT")%>%
  filter(term_year=="2021")



r5<- df_Degrees%>%
  filter(full_part=="PT")%>%
  filter(term_year=="2020")

```

```{r}
wilcox.test(r4$hours_earned,r5$hours_earned)

```



Students who earned less than 3 hours
```{r}

df_Degrees%>% group_by(term_year,full_part)%>%
                      count(hours_earned<3)

```

Hours earned equate to credits earned and is the indication of the progress a student is making towards a degree.
In term year 2020, 240 full time and 727 part time students earned less than 3 credits.
In term year 2021, 290 full time and 504 part time earned less than 3 credits.

Students who earned more than 18 credits
```{r}

df_Degrees%>% group_by(term_year,full_part)%>%
                      count(hours_earned>18)

```


# Create New Variable hours_earned_rate
```{r}
# create variable pass_earned_hours
# hours_earned_rate = hours_earned/hours_attempted

df_Degrees<-df_Degrees %>%
           mutate(hours_earned_rate=hours_earned/hours_attempted)

```

Density plot of Hours Earned Rate by year
```{r}
ggplot(df_Degrees, aes(hours_earned_rate, fill = term_year)) + geom_density(alpha = 0.3) +
  facet_wrap(~full_part)+
  xlab("Hours Earned Rate") +
  ylab( "Density")+
  xlim(0,1)
```


Hours Earned Fivenum Summary
```{r}
df_Degrees%>% group_by(full_part,term_year)%>%
  summarise(n = n(),
            min = fivenum(hours_earned_rate)[1],
            Q1 = fivenum(hours_earned_rate)[2],
            median = fivenum(hours_earned_rate)[3],
            Q3 = fivenum(hours_earned_rate)[4],
            max = fivenum(hours_earned_rate)[5],
            mean= mean(hours_earned_rate),
            sd = sd(hours_earned_rate))


```

Full-time: Q1 and Q3 are slightly lower in term year 2021 than term year 2020, hence full time students were slightly less efficient in earning hours in term year 2021.

Part-time: The median is higher in 2021, however the 3rd quartile is higher in term year 2020. 


# GPA 
Histogram of GPA by year
```{r}

p <- ggplot(df_Degrees, aes(x = mc_gpa))+ geom_histogram(aes(fill = term_year))
p7<- p + facet_wrap(~full_part)

p7
```

Boxplots of GPA by year
```{r}
p15 = ggplot(df_Degrees, aes(mc_gpa))
p15 + geom_boxplot(aes(colour = term_year)) +
       facet_wrap(~full_part)
```

Density plot of GPA by year
```{r}
ggplot(df_Degrees, aes(mc_gpa, fill = term_year)) + geom_density(alpha = 0.2) +
  facet_wrap(~full_part)+
  xlab("GPA") +
  ylab( "Density")

```

GPA Fivenum Summary
```{r}
df_Degrees%>% group_by(full_part,term_year)%>%
  summarise(n = n(),
            min = fivenum(mc_gpa)[1],
            Q1 = fivenum(mc_gpa)[2],
            median = fivenum(mc_gpa)[3],
            Q3 = fivenum(mc_gpa)[4],
            max = fivenum(mc_gpa)[5],
            mean= mean(mc_gpa),
            sd = sd(mc_gpa))


```


Full time: The 1st quartile, median and 3rd quartile in term year 2020 is very close, but slightly higher to those in term year 2021.
This difference is 0.19 in Q1, 0.065 in Q2 (median) and 0.17 in Q3. As GPA is out of 4, a change of 0.19/4 = 4.75%. 
Part time: The median GPA for part time students in term year 2021 is 2.00. The median GPA in term year 2020 is 1.63. The 3rd quartile in term year 2021 is 3.33. The 3rd quartile in term year 2020 is 3. 
As the median and 3rd quartile in term year 2021 are higher than those in term year 2020, we can conclude that overall the
part time students in 2021 performed better than those in term year 2020. As GPA is out of 4, a change of 0.37/4 = 9.25%.

As a GPA of 2 is required to remain in good standing at the college, one needs to check the proportion of students with GPA >=2.


```{r}

df_Degrees%>% 
            group_by(term_year,full_part)%>%
            count(mc_gpa>=2)%>%
            arrange(term_year,.by_group=TRUE)%>%
            mutate(pct_pass= n/(n+lag(n))*100)


```

Full time: In term year 2020, 72.64% of the full time students were in good standing. In term year 2021 69.54% of the full time students were in good standing. This is a decrease of 3.1%

Part time: In term year 2020, 48.78% of the part time students were in good standing. In term year 2021 51.78% of the part time students were in good standing. This is an increase of 3.1%.


# Distribution of Variables and Correlation 
```{r,message=FALSE}

library(GGally)
# plot distributions and correlation of variables
df_Degrees%>% filter(term_year=="2020")%>%
              filter(full_part=="FT")%>%
              ggpairs(., columns = c("hours_attempted","hours_earned", "mc_gpa","hours_earned_rate"))

```


------
Save data Frames for statistical analysis.
```{r}
write_csv(df_Degrees,"Degrees_Data.csv")

```


mutate(atopic_derm = ifelse(atopic_derm_start>0,1,0))%>%
mutate(rhinitis = ifelse(allergic_rhinitis_start>0,1,0))%>%
#mutate(asthma= ifelse(num_asthmarx>1,1,0))     # only define as a asthma patient if had more than 1 prescription of asthma medication
mutate(asthma= ifelse(asthma_start>1,1,0))
bc_df_binary<-bc_df_binary%>%
select(c(1:6,51:68))
bc_df_binary<-bc_df_binary%>%
mutate(num_food_allergies=rowSums(.[7:21]))
bc_df_binary<-bc_df_binary%>%
mutate(food_allergy = ifelse(num_food_allergies<1,0,1))
# Food Allergy and Asthma
FA_Asthma <- bc_df_binary%>%
filter(asthma==1 &food_allergy==1)%>%
count()
# No Food Allergy and Asthma
nFA_Asthma<-bc_df_binary%>%
filter(asthma==1 &food_allergy==0)%>%
count()
# Food Allergy and No Asthma
FA_nAsthma<-bc_df_binary%>%
filter(asthma==0 &food_allergy==1)%>%
count()
# No Food Allergy and No Asthma
nFA_nAsthma<-bc_df_binary%>%
filter(asthma==0 &food_allergy==0)%>%
count()
FA_Asthma<-as.numeric(FA_Asthma)
FA_nAsthma<-as.numeric(FA_nAsthma)
nFA_Asthma<-as.numeric(nFA_Asthma)
nFA_nAsthma<-as.numeric(nFA_nAsthma)
#H1matrix<-matrix(c(1766,1033,11463,15400),ncol=2,byrow=TRUE)
H1matrix<-matrix(c(FA_Asthma, FA_nAsthma, nFA_Asthma, nFA_nAsthma), ncol=2,byrow=TRUE)
rownames(H1matrix)<-c("Food Allergy","No Food Allergy")
colnames(H1matrix)<-c("Asthma","No Asthma")
H1matrix <- as.table(H1matrix)
H1matrix
food_allergy<-c(FA_Asthma,FA_nAsthma)
no_food_allergy<-c(nFA_Asthma,nFA_nAsthma)
test<-data.frame(food_allergy,no_food_allergy)
test
chisq.test(test)
# Food Allergy and Asthma
FA_Rhin <- bc_df_binary%>%
filter(rhinitis==1 &food_allergy==1)%>%
count()
# No Food Allergy and Asthma
nFA_Rhin<-bc_df_binary%>%
filter(rhinitis==1 &food_allergy==0)%>%
count()
# Food Allergy and No Asthma
FA_nRhin<-bc_df_binary%>%
filter(rhinitis==0 &food_allergy==1)%>%
count()
# No Food Allergy and No Asthma
nFA_nRhin<-bc_df_binary%>%
filter(rhinitis==0 &food_allergy==0)%>%
count()
FA_Rhin <- as.numeric(FA_Rhin)
FA_nRhin <- as.numeric(FA_nRhin)
nFA_Rhin <- as.numeric(nFA_Rhin)
nFA_nRhin <- as.numeric(nFA_nRhin)
H2matrix<-matrix(c(FA_Rhin,FA_nRhin,nFA_Rhin,nFA_nRhin),ncol=2,byrow=TRUE)
rownames(H2matrix)<-c("Food Allergy","No Food Allergy")
colnames(H2matrix)<-c("Rhinitis","No Rhinitis")
H2matrix <- as.table(H2matrix)
H2matrix
food_allergy2<-c(FA_Rhin,FA_nRhin)
no_food_allergy2<-c(nFA_Rhin,nFA_nRhin)
test<-data.frame(food_allergy2,no_food_allergy2)
test
chisq.test(test)
# Food Allergy and Asthma
FA_AD <- bc_df_binary%>%
filter(atopic_derm==1 &food_allergy==1)%>%
count()
# No Food Allergy and Asthma
nFA_AD<-bc_df_binary%>%
filter(atopic_derm==1 &food_allergy==0)%>%
count()
# Food Allergy and No Asthma
FA_nAD<-bc_df_binary%>%
filter(atopic_derm==0 &food_allergy==1)%>%
count()
# No Food Allergy and No Asthma
nFA_nAD<-bc_df_binary%>%
filter(atopic_derm==0 &food_allergy==0)%>%
count()
FA_AD<- as.numeric(FA_AD)
FA_nAD<- as.numeric(FA_nAD)
nFA_AD<- as.numeric(nFA_AD)
nFA_nAD<- as.numeric(nFA_nAD)
H3matrix<-matrix(c(FA_AD,FA_nAD,nFA_AD,nFA_nAD),ncol=2,byrow=TRUE)
rownames(H3matrix)<-c("Food Allergy","No Food Allergy")
colnames(H3matrix)<-c("Atopic Dermatitis","No Dermatitis")
H3matrix <- as.table(H3matrix)
H3matrix
food_allergy3<-c(FA_AD,FA_nAD)
no_food_allergy3<-c(nFA_AD,nFA_nAD)
test<-data.frame(food_allergy3,no_food_allergy3)
test
chisq.test(test)
food_allergy<-c(FA_Asthma,FA_nAsthma)
no_food_allergy<-c(nFA_Asthma,nFA_nAsthma)
test<-data.frame(food_allergy,no_food_allergy)
test
chisq.test(test)
# Food Allergy and Asthma
FA_Rhin <- bc_df_binary%>%
filter(rhinitis==1 &food_allergy==1)%>%
count()
# No Food Allergy and Asthma
nFA_Rhin<-bc_df_binary%>%
filter(rhinitis==1 &food_allergy==0)%>%
count()
# Food Allergy and No Asthma
FA_nRhin<-bc_df_binary%>%
filter(rhinitis==0 &food_allergy==1)%>%
count()
# No Food Allergy and No Asthma
nFA_nRhin<-bc_df_binary%>%
filter(rhinitis==0 &food_allergy==0)%>%
count()
FA_Rhin <- as.numeric(FA_Rhin)
FA_nRhin <- as.numeric(FA_nRhin)
nFA_Rhin <- as.numeric(nFA_Rhin)
nFA_nRhin <- as.numeric(nFA_nRhin)
View(bc_df)
View(bc_df)
FA_AsthmaOdds_df< -bc_df%>%
select(c(1:6,seq(10, 48, by = 2),49))
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 48, by = 2),49))
View(FA_AsthmaOdds_df)
View(FA_AsthmaOdds_df)
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
View(FA_AsthmaOdds_df)
View(FA_AsthmaOdds_df)
View(FA_AsthmaOdds_df)
View(FA_AsthmaOdds_df)
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
FA_AsthmaOdds_df<- FA_AsthmaOdds_df%>%
mutate(allergy_start = min(column7:column22))
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
FA_AsthmaOdds_df<- FA_AsthmaOdds_df%>%
mutate(allergy_start = min(column 7:column 22))
View(FA_AsthmaOdds_df)
View(FA_AsthmaOdds_df)
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
FA_AsthmaOdds_df<- FA_AsthmaOdds_df%>%
mutate(allergy_start = min(FA_AsthmaOdds_df(c(7:22))))
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
names(FA_AsthmaOdds_df)
#FA_AsthmaOdds_df<- FA_AsthmaOdds_df%>%
#  mutate(allergy_start = min(FA_AsthmaOdds_df(c(7:22))))
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
names(FA_AsthmaOdds_df)
#FA_AsthmaOdds_df<- FA_AsthmaOdds_df%>%
mutate(allergy_start = min(
shellfish_alg_start, fish_alg_start,
milk_alg_start, soy_alg_start, egg_alg_start, wheat_alg_start,
peanut_alg_start, sesame_alg_start,treenut_alg_start,walnut_alg_start,
pecan_alg_start, pistach_alg_start,almond_alg_start, brazil_alg_start ,
hazelnut_alg_start, cashew_alg_start))
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
names(FA_AsthmaOdds_df)
#FA_AsthmaOdds_df<- FA_AsthmaOdds_df%>%
mutate(allergy_start = min(
shellfish_alg_start, fish_alg_start,
milk_alg_start, soy_alg_start, egg_alg_start, wheat_alg_start,
peanut_alg_start, sesame_alg_start,treenut_alg_start,walnut_alg_start,
pecan_alg_start, pistach_alg_start,almond_alg_start, brazil_alg_start ,
hazelnut_alg_start, cashew_alg_start), na.rm=T)
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
names(FA_AsthmaOdds_df)
#FA_AsthmaOdds_df<- FA_AsthmaOdds_df%>%
mutate(allergy_start = min ((
shellfish_alg_start, fish_alg_start,
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
names(FA_AsthmaOdds_df)
FA_AsthmaOdds_df<- FA_AsthmaOdds_df%>%
mutate(allergy_start = min ((
shellfish_alg_start, fish_alg_start,
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
names(FA_AsthmaOdds_df)
FA_AsthmaOdds_df<- FA_AsthmaOdds_df%>%
mutate(allergy_start = min (
shellfish_alg_start, fish_alg_start,
milk_alg_start, soy_alg_start, egg_alg_start, wheat_alg_start,
peanut_alg_start, sesame_alg_start,treenut_alg_start,walnut_alg_start,
pecan_alg_start, pistach_alg_start,almond_alg_start, brazil_alg_start ,
hazelnut_alg_start, cashew_alg_start)
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
names(FA_AsthmaOdds_df)
FA_AsthmaOdds_df<- FA_AsthmaOdds_df%>%
mutate(allergy_start = min (shellfish_alg_start, fish_alg_start,
milk_alg_start, soy_alg_start, egg_alg_start, wheat_alg_start,
peanut_alg_start, sesame_alg_start,treenut_alg_start,walnut_alg_start,
pecan_alg_start, pistach_alg_start,almond_alg_start, brazil_alg_start ,
hazelnut_alg_start, cashew_alg_start)
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
names(FA_AsthmaOdds_df)
FA_AsthmaOdds_df<- FA_AsthmaOdds_df %>%
mutate(allergy_start = min (shellfish_alg_start, fish_alg_start,
milk_alg_start, soy_alg_start, egg_alg_start, wheat_alg_start,
peanut_alg_start, sesame_alg_start,treenut_alg_start,walnut_alg_start,
pecan_alg_start, pistach_alg_start,almond_alg_start, brazil_alg_start ,
hazelnut_alg_start, cashew_alg_start)
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
names(FA_AsthmaOdds_df)
FA_AsthmaOdds_df<- FA_AsthmaOdds_df %>%
mutate(allergy_start = min (shellfish_alg_start, fish_alg_start,
milk_alg_start, soy_alg_start, egg_alg_start, wheat_alg_start,
peanut_alg_start, sesame_alg_start,treenut_alg_start,walnut_alg_start,
pecan_alg_start, pistach_alg_start,almond_alg_start, brazil_alg_start ,
hazelnut_alg_start, cashew_alg_start))
View(FA_AsthmaOdds_df)
View(FA_AsthmaOdds_df)
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
names(FA_AsthmaOdds_df)
FA_AsthmaOdds_df<- FA_AsthmaOdds_df %>%
mutate(allergy_start = min (shellfish_alg_start, fish_alg_start,
milk_alg_start, soy_alg_start, egg_alg_start, wheat_alg_start,
peanut_alg_start, sesame_alg_start,treenut_alg_start,walnut_alg_start,
pecan_alg_start, pistach_alg_start,almond_alg_start, brazil_alg_start ,
hazelnut_alg_start, cashew_alg_start,na.rm=TRUE))
View(FA_AsthmaOdds_df)
View(FA_AsthmaOdds_df)
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
names(FA_AsthmaOdds_df)
FA_AsthmaOdds_df<- FA_AsthmaOdds_df %>%
row_wise()%>%
mutate(allergy_start = min (shellfish_alg_start, fish_alg_start,
milk_alg_start, soy_alg_start, egg_alg_start, wheat_alg_start,
peanut_alg_start, sesame_alg_start,treenut_alg_start,walnut_alg_start,
pecan_alg_start, pistach_alg_start,almond_alg_start, brazil_alg_start ,
hazelnut_alg_start, cashew_alg_start,na.rm=TRUE))
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
names(FA_AsthmaOdds_df)
FA_AsthmaOdds_df<- FA_AsthmaOdds_df %>%
rowwise()%>%
mutate(allergy_start = min (shellfish_alg_start, fish_alg_start,
milk_alg_start, soy_alg_start, egg_alg_start, wheat_alg_start,
peanut_alg_start, sesame_alg_start,treenut_alg_start,walnut_alg_start,
pecan_alg_start, pistach_alg_start,almond_alg_start, brazil_alg_start ,
hazelnut_alg_start, cashew_alg_start,na.rm=TRUE))
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
names(FA_AsthmaOdds_df)
FA_AsthmaOdds_df<- FA_AsthmaOdds_df %>%
rowwise()%>%
mutate(allergy_start = min (shellfish_alg_start, fish_alg_start,
milk_alg_start, soy_alg_start, egg_alg_start, wheat_alg_start,
peanut_alg_start, sesame_alg_start,treenut_alg_start,walnut_alg_start,
pecan_alg_start, pistach_alg_start,almond_alg_start, brazil_alg_start ,
hazelnut_alg_start, cashew_alg_start,na.rm=TRUE))
knitr::opts_chunk$set(echo = TRUE)
#import libraries
library(tidyverse)
library(ggplot2)
library(readxl)
library (janitor)
library(skimr)
library(plotly)
library(scales)
library(httr)
library(jsonlite)
library(lubridate)
setwd("/Users/ulita/Documents/Biostats/Project")
df_initial<-read_csv("/Users/ulita/Documents/Biostats/Project/food-allergy-analysis-Zenodo.csv")
#clean names using janitor package
df_initial<-df_initial %>%
clean_names()
# summary statistics of dataframing using function skimr creates a table of summary statistics of all variables in the dataframe
skim(df_initial)
df_initial$sesame_alg_end<- as.numeric(df_initial$sesame_alg_end)
df_initial$treenut_alg_start <- as.numeric(df_initial$treenut_alg_start)
df_initial$treenut_alg_end<- as.numeric(df_initial$treenut_alg_end)
df_initial$walnut_alg_end<- as.numeric(df_initial$walnut_alg_end)
df_initial$pecan_alg_end<- as.numeric(df_initial$pecan_alg_end)
df_initial$pistach_alg_end<- as.numeric(df_initial$pistach_alg_end)
df_initial$almond_alg_end <- as.numeric(df_initial$almond_alg_end )
df_initial$brazil_alg_start<- as.numeric(df_initial$brazil_alg_start)
df_initial$brazil_alg_end<- as.numeric(df_initial$brazil_alg_end)
df_initial$cashew_alg_end<- as.numeric(df_initial$cashew_alg_end)
# summary statistics of dataframing using function skimr creates a table of summary statistics of all variables in the dataframe
skim(df_initial)
# check the column atopic_march_cohort to see if the number of patients equal those used in the study.
df_initial%>%count(atopic_march_cohort)
bc_df<-df_initial%>%
filter(atopic_march_cohort=="TRUE")
skim(bc_df)
# Gender of participants
ggplot(data=bc_df, aes(x=gender_factor, fill=gender_factor)) +
geom_bar() +
geom_text(stat='count', aes(label=..count..), vjust=2,size=3)+
ggtitle("Gender of Patients")+
ylab('Frequency')+
xlab("")+
theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
bc_df %>%
count(gender_factor) %>%
mutate(prop = n/sum(n)) %>%
ggplot(aes(x = gender_factor, y = prop)) +
geom_col(aes(fill = gender_factor), position = "dodge") +
geom_text(aes(label = scales::percent(prop),
y = prop,
group = gender_factor),
position = position_dodge(width = 0.9),
vjust = 2,size=3)+
ggtitle("Gender of Patients")+
ylab('Percentage')+
xlab("")+
theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
bc_df %>%
count(race_factor) %>%
mutate(prop = n/sum(n)) %>%
ggplot(aes(x = race_factor, y = prop)) +
geom_col(aes(fill = race_factor), position = "dodge") +
geom_text(aes(label = scales::percent(prop),
y = prop,
group = race_factor),
position = position_dodge(width = 0.9),
vjust = 2,size=3)+
ggtitle("Racial breakdown of Patients in Study")+
ylab('Percentage')+
xlab("")+
theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
# Raceof participants
ggplot(data=bc_df, aes(x=race_factor, fill=race_factor)) +
geom_bar() +
geom_text(stat='count', aes(label=..count..), vjust=2,size=3)+
ggtitle("Racial breakdown of Patients in Study")+
ylab('Frequency')+
xlab("")+
theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
bc_df %>%
count(payer_factor) %>%
mutate(prop = n/sum(n)) %>%
ggplot(aes(x = payer_factor, y = prop)) +
geom_col(aes(fill = payer_factor), position = "dodge") +
geom_text(aes(label = scales::percent(prop),
y = prop,
group = payer_factor),
position = position_dodge(width = 0.9),
vjust = 2,size=3)+
ggtitle("Medicaid versus non Medicaid")+
ylab('Percentage')+
xlab("")+
theme(axis.text.x=element_blank(),strip.background = element_blank(),panel.grid = element_blank())
bc_df %>%
count(birth_year) %>%
mutate(prop = n/sum(n)) %>%
ggplot(aes(x = birth_year, y = prop)) +
geom_col(aes(fill = birth_year), position = "dodge") +
geom_text(aes(label = scales::percent(prop),
y = prop,
group = birth_year),
position = position_dodge(width = 0.9),
vjust = 2,size=3)+
ggtitle("Birth Year of Participants")+
ylab('Percentage')+
xlab("Birth Year")+
scale_fill_gradient(low="yellow", high="purple")+
theme(strip.background = element_blank(),panel.grid = element_blank())
# create new dataframe of 1 and 0s for each variable of interest.
#1 if condition is present.
# 0 if condition is absent.
bc_df_binary<-data.frame(bc_df)
bc_df_binary[is.na(bc_df_binary)]=0
names(bc_df)
bc_df_binary<- bc_df_binary%>%
mutate(shellfish= ifelse(shellfish_alg_start>0,1,0))%>%
mutate(fish= ifelse(fish_alg_start>0,1,0))%>%
mutate(milk= ifelse(milk_alg_start>0,1,0))%>%
mutate(soy = ifelse(soy_alg_start>0,1,0))%>%
mutate(egg = ifelse(egg_alg_start>0,1,0))%>%
mutate(wheat = ifelse(wheat_alg_start>0,1,0))%>%
mutate(peanut = ifelse(peanut_alg_start>0,1,0))%>%
mutate(sesame = ifelse(sesame_alg_start>0,1,0))%>%
mutate(treenut= ifelse(treenut_alg_start>0,1,0))%>%
mutate(walnut = ifelse(walnut_alg_start>0,1,0))%>%
mutate(pistach = ifelse(pistach_alg_start>0,1,0))%>%
mutate(almond = ifelse(almond_alg_start>0,1,0))%>%
mutate(brazil = ifelse(brazil_alg_start>0,1,0))%>%
mutate(hazelnut = ifelse(hazelnut_alg_start>0,1,0))%>%
mutate(cashew = ifelse(cashew_alg_start>0,1,0))%>%
mutate(atopic_derm = ifelse(atopic_derm_start>0,1,0))%>%
mutate(rhinitis = ifelse(allergic_rhinitis_start>0,1,0))%>%
#mutate(asthma= ifelse(num_asthmarx>1,1,0))     # only define as a asthma patient if had more than 1 prescription of asthma medication
mutate(asthma= ifelse(asthma_start>1,1,0))
bc_df_binary<-bc_df_binary%>%
select(c(1:6,51:68))
bc_df_binary<-bc_df_binary%>%
mutate(num_food_allergies=rowSums(.[7:21]))
bc_df_binary<-bc_df_binary%>%
mutate(food_allergy = ifelse(num_food_allergies<1,0,1))
# Food Allergy and Asthma
FA_Asthma <- bc_df_binary%>%
filter(asthma==1 &food_allergy==1)%>%
count()
# No Food Allergy and Asthma
nFA_Asthma<-bc_df_binary%>%
filter(asthma==1 &food_allergy==0)%>%
count()
# Food Allergy and No Asthma
FA_nAsthma<-bc_df_binary%>%
filter(asthma==0 &food_allergy==1)%>%
count()
# No Food Allergy and No Asthma
nFA_nAsthma<-bc_df_binary%>%
filter(asthma==0 &food_allergy==0)%>%
count()
FA_Asthma<-as.numeric(FA_Asthma)
FA_nAsthma<-as.numeric(FA_nAsthma)
nFA_Asthma<-as.numeric(nFA_Asthma)
nFA_nAsthma<-as.numeric(nFA_nAsthma)
#H1matrix<-matrix(c(1766,1033,11463,15400),ncol=2,byrow=TRUE)
H1matrix<-matrix(c(FA_Asthma, FA_nAsthma, nFA_Asthma, nFA_nAsthma), ncol=2,byrow=TRUE)
rownames(H1matrix)<-c("Food Allergy","No Food Allergy")
colnames(H1matrix)<-c("Asthma","No Asthma")
H1matrix <- as.table(H1matrix)
H1matrix
food_allergy<-c(FA_Asthma,FA_nAsthma)
no_food_allergy<-c(nFA_Asthma,nFA_nAsthma)
test<-data.frame(food_allergy,no_food_allergy)
test
chisq.test(test)
# Food Allergy and Asthma
FA_Rhin <- bc_df_binary%>%
filter(rhinitis==1 &food_allergy==1)%>%
count()
# No Food Allergy and Asthma
nFA_Rhin<-bc_df_binary%>%
filter(rhinitis==1 &food_allergy==0)%>%
count()
# Food Allergy and No Asthma
FA_nRhin<-bc_df_binary%>%
filter(rhinitis==0 &food_allergy==1)%>%
count()
# No Food Allergy and No Asthma
nFA_nRhin<-bc_df_binary%>%
filter(rhinitis==0 &food_allergy==0)%>%
count()
FA_Rhin <- as.numeric(FA_Rhin)
FA_nRhin <- as.numeric(FA_nRhin)
nFA_Rhin <- as.numeric(nFA_Rhin)
nFA_nRhin <- as.numeric(nFA_nRhin)
H2matrix<-matrix(c(FA_Rhin,FA_nRhin,nFA_Rhin,nFA_nRhin),ncol=2,byrow=TRUE)
rownames(H2matrix)<-c("Food Allergy","No Food Allergy")
colnames(H2matrix)<-c("Rhinitis","No Rhinitis")
H2matrix <- as.table(H2matrix)
H2matrix
food_allergy2<-c(FA_Rhin,FA_nRhin)
no_food_allergy2<-c(nFA_Rhin,nFA_nRhin)
test<-data.frame(food_allergy2,no_food_allergy2)
test
chisq.test(test)
# Food Allergy and Asthma
FA_AD <- bc_df_binary%>%
filter(atopic_derm==1 &food_allergy==1)%>%
count()
# No Food Allergy and Asthma
nFA_AD<-bc_df_binary%>%
filter(atopic_derm==1 &food_allergy==0)%>%
count()
# Food Allergy and No Asthma
FA_nAD<-bc_df_binary%>%
filter(atopic_derm==0 &food_allergy==1)%>%
count()
# No Food Allergy and No Asthma
nFA_nAD<-bc_df_binary%>%
filter(atopic_derm==0 &food_allergy==0)%>%
count()
FA_AD<- as.numeric(FA_AD)
FA_nAD<- as.numeric(FA_nAD)
nFA_AD<- as.numeric(nFA_AD)
nFA_nAD<- as.numeric(nFA_nAD)
H3matrix<-matrix(c(FA_AD,FA_nAD,nFA_AD,nFA_nAD),ncol=2,byrow=TRUE)
rownames(H3matrix)<-c("Food Allergy","No Food Allergy")
colnames(H3matrix)<-c("Atopic Dermatitis","No Dermatitis")
H3matrix <- as.table(H3matrix)
H3matrix
food_allergy3<-c(FA_AD,FA_nAD)
no_food_allergy3<-c(nFA_AD,nFA_nAD)
test<-data.frame(food_allergy3,no_food_allergy3)
test
chisq.test(test)
FA_AsthmaOdds_df<- bc_df%>%
select(c(1:6,seq(10, 50, by = 2)))
names(FA_AsthmaOdds_df)
FA_AsthmaOdds_df<- FA_AsthmaOdds_df%>%
mutate(allergy_start = min (shellfish_alg_start, fish_alg_start,
milk_alg_start, soy_alg_start, egg_alg_start, wheat_alg_start,
peanut_alg_start, sesame_alg_start,treenut_alg_start,walnut_alg_start,
pecan_alg_start, pistach_alg_start,almond_alg_start, brazil_alg_start ,
hazelnut_alg_start, cashew_alg_start,na.rm=TRUE))
